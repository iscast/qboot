<div class="layui-card">
    <div class="layui-card-body">
        <div class="layui-form toolbar">
        </div>
        <div id="loginLogLayTable">
            <table class="layui-table loginLog_auth" id="loginLog-table" lay-filter="loginLog-table" data-auth="mon:loginLog:qry"></table>
        </div>
    </div>
</div>
<script>
    layui.use(['laydate', 'form', 'table', 'util', '_config', 'admin', 'formSelects'], function () {
        var laydate = layui.laydate;
        var form = layui.form;
        var table = layui.table;
        var _config = layui._config;
        var layer = layui.layer;
        var util = layui.util;
        var admin = layui.admin;
        var formSelects = layui.formSelects;

        table.render({
            elem: '#loginLog-table',
            url: _config.base_server + '/mon/loginlog/qryOnlineUser',
            where: {
                userId: $('#userId').val(), loginName: $('#loginName').val(),userName:$('#userName').val()
            },
            method: 'post',
            cols: [[
                {type: 'numbers'},
                {field: 'userId', sort: true, title: '用户ID'},
                {field: 'loginName', sort: true, title: '登录名'},
                {field: 'userName', sort: true, title: '用户名'},
                {field: 'loginTime', sort: true, templet: function (d) {
                        return util.toDateString(d.loginTime);
                    }, title: '登录时间'},
                {field: 'ip', sort: true, title: 'IP地址'},
                {field: 'firstLogin', templet: function (data){
                        var vname = '正常';
                        if(data.firstLogin == 1){
                            vname = '初始化密码';
                        }else if(data.firstLogin == 2){
                            vname = '修改密码';
                        }
                        return vname;
                    }, title: '状态标识'}
            ]]
        });

        $('#loginLogLayTable').on('click', 'tbody tr', function (e) {
            var fals = $(this).hasClass('layui-table-click');
            if(!fals){
                $(this).addClass('layui-table-click');
            }else{
                $(this).removeClass('layui-table-click');
            }
        });

        $('#loginLog-btn-search').click(function () {
            table.reload('loginLog-table', {where: {userId: $('#userId').val(), loginName: $('#loginName').val(),userName:$('#userName').val(),startDate:$('#startDate').val(),endDate:$('#endDate').val()}, page:1});
        });

    });
</script>